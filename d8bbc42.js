(window.webpackJsonp=window.webpackJsonp||[]).push([[9,5],{1049:function(e,t,n){var content=n(1066);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(56).default)("03c8ab09",content,!0,{sourceMap:!1})},1065:function(e,t,n){"use strict";n(1049)},1066:function(e,t,n){var o=n(55)((function(i){return i[1]}));o.push([e.i,'.arrow[data-v-1d5e5f7a],.arrow[data-v-1d5e5f7a]:before{position:absolute}.arrow[data-v-1d5e5f7a]{top:70%;left:30%;margin:-20px 0 0 -20px;-webkit-transform:rotate(45deg);border-right:2px solid #fff;border-top:2px solid #fff}.arrow[data-v-1d5e5f7a],.arrow[data-v-1d5e5f7a]:before{width:20px;height:20px;border-left:none}.arrow[data-v-1d5e5f7a]:before{content:"";top:50%;margin:-10px 0 0 -10px;border-right:1px solid #fff;border-top:1px solid #fff;-webkit-animation-duration:1.5s;animation-duration:1.5s;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;-webkit-animation-name:arrow-data-v-1d5e5f7a;animation-name:arrow-data-v-1d5e5f7a}@-webkit-keyframes arrow-data-v-1d5e5f7a{0%{opacity:0;transform:translate(-2px,2px)}50%{opacity:1}to{opacity:0;transform:translate(13px,-13px)}}@keyframes arrow-data-v-1d5e5f7a{0%{opacity:0;transform:translate(-2px,2px)}50%{opacity:1}to{opacity:0;transform:translate(13px,-13px)}}',""]),e.exports=o},1067:function(e,t,n){var content=n(1101);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(56).default)("62b754cc",content,!0,{sourceMap:!1})},1084:function(e,t,n){"use strict";n.r(t);n(1065);var o=n(42),component=Object(o.a)({},(function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"arrow"})}),[],!1,null,"1d5e5f7a",null);t.default=component.exports},1100:function(e,t,n){"use strict";n(1067)},1101:function(e,t,n){var o=n(55)((function(i){return i[1]}));o.push([e.i,".connections-control{position:fixed;bottom:0;left:0;width:100%;height:3.2rem;padding:0}.connections-control .connect-button{border-radius:0;font-size:1.6rem;width:100%}",""]),e.exports=o},1128:function(e,t,n){"use strict";n.r(t);n(8),n(79),n(97),n(25),n(68);var o=n(5),r=(n(99),n(1039)),c=n(16),l=n(1084);window.onerror=function(e,source,t,n,o){console.log("Exception: ",o.message.startsWith("EPERM:"))};var d={components:{Arrow:l.default},data:function(){return{connectButtonLoading:!1,connectButtonDisabled:!1}},computed:{connectButtonText:function(){return this.connected?this.$t("disconnect"):this.$t("connect")}},methods:{connectAction:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var n,o,r,l,d,f;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.connectButtonLoading=!0,n=e.connected?"disconnect":"connect","darwin"!==c.remote.process.platform){t.next=24;break}if(o="".concat(c.remote.app.getPath("userData"),"/ProxyConfig"),t.prev=4,r=c.remote.require("fs-extra"),l=r.fstatSync(r.openSync(o)),console.log("ProxyConfig perm is:",l),0===l.uid){t.next=19;break}return console.log("UID is not root. will force reinstall helper."),t.prev=10,t.next=13,r.remove(o);case 13:console.log("ProxyConfig deleted."),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(10),console.log("delete ProxyConfig failed:",t.t0);case 19:t.next=24;break;case 21:t.prev=21,t.t1=t.catch(4),console.log("ready perm of ProxyConfig failed",t.t1);case 24:if(console.log("performing action: "+n),"connect"!==n){t.next=29;break}if(e.runTimeState.selected_line&&e.runTimeState.selected_line.name){t.next=29;break}return e.connectButtonLoading=!1,t.abrupt("return",e.$message({message:e.$t("connect_info.select_line"),type:"error"}));case 29:return t.prev=29,t.next=32,e[n]();case 32:t.next=38;break;case 34:t.prev=34,t.t2=t.catch(29),console.log("---\x3e>> action failed:",t.t2),["connect timeout","disconnect timeout"].includes(t.t2.message)?e.$message({message:e.$t("error.timeout"),type:"error"}):((d=e.shouldIgnoreError(t.t2)).ignore?(console.log("will not report to sentry."),console.log("matched error:",d.matchedError)):e.$sentry.captureException(t.t2),f=e.errorMessageAssemble(t.t2),console.table(t.t2),"EPERM"===d.matchedError&&(f+="<br>".concat(e.$t("error.eperm"))),["ENOENT","UNKNOWN"].includes(d.matchedError)&&("darwin"===c.remote.process.platform?f+="<br>".concat(e.$t("error.enoent")):"win32"===c.remote.process.platform&&("ia32"===c.remote.process.arch?f+="<br>".concat(e.$t("error.clash")):f+="<br>".concat(e.$t("error.missing")))),"Command failed"===d.matchedError&&(f+="<br>".concat(e.$t("error.restart"))),e.$alert(f,e.$t("error.connect_failed"),{confirmButtonText:"OK",dangerouslyUseHTMLString:!0}));case 38:e.connectButtonLoading=!1;case 39:case"end":return t.stop()}}),t,null,[[4,21],[10,16],[29,34]])})))()},connect:function(){var e=this;return this.runTimeState.show_access_mode||this.$store.dispatch("runTimeState",{servermode:"auto"}),new Promise((function(t,n){var o=setTimeout((function(){n(new Error("connect timeout"))}),8e3);c.ipcRenderer.once("connect-reply",(function(l,d){if(console.log(d),Object(r.clearTimeout)(o),d.failed)console.log("connect failed:",d.reason),n(d.reason);else{var f={line:JSON.parse(JSON.stringify(e.runTimeState.selected_line)),servermode:e.runTimeState.servermode,status:"connected"};e.$store.dispatch("runTimeState",{connect_state:f}),c.ipcRenderer.send("user-info-update",4),t(d)}})),c.ipcRenderer.send("connect",e.runTimeState.selected_line.name)}))},disconnect:function(){var e=this;return new Promise((function(t,n){var o=setTimeout((function(){n(new Error("disconnect timeout"))}),5e3);c.ipcRenderer.once("disconnect-reply",(function(l,d){if(console.log("dis reply--\x3e>",d),Object(r.clearTimeout)(o),d.failed)return console.log("gonna trorw an error"),console.log("disconnect failed:",d.reason),n(d.reason);var f={line:{},servermode:e.runTimeState.servermode,status:"disconnected"};e.$store.dispatch("runTimeState",{connect_state:f}),c.ipcRenderer.send("user-info-update",5),t(d)})),c.ipcRenderer.send("disconnect",e.runTimeState.selected_line.name)}))}}},f=(n(1100),n(42)),component=Object(f.a)(d,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-row",{staticClass:"connections-control"},[n("el-button",{staticClass:"connect-button",attrs:{type:"connected"==e.runTimeState.connect_state.status?"warning":"primary",loading:e.connectButtonLoading,disabled:e.connectButtonDisabled||e.connectButtonLoading},on:{click:e.connectAction}},[e._v(" "+e._s(e.connectButtonText))])],1)}),[],!1,null,null,null);t.default=component.exports}}]);